<app-lesson-terminal-provider
  (connectionStateChange)="connectionStateChanged($event)"
  (terminalMessage)="handleTerminalMessage($event)"
  >

  <div class="terminal-page">

    <div class="status-bar">
      <div>{{pageTitle}}</div>
      <div class="flex-spacer"></div>
      <div *ngIf="lessonConnected && username" class="horizontal-stack" style="gap: 0">
        <app-avatar-view
          *ngIf="lessonConnected && username"
          [avatar]="selectedAvatar"
          size="small">
        </app-avatar-view>
        &nbsp;
        {{username}}
      </div>

      <div *ngIf="lessonConnected && username">
        |
      </div>

      <div *ngIf="lessonConnected">
        מחובר לשיעור
      </div>
      <div *ngIf="!lessonConnected">
        לא מחובר לשיעור
      </div>
    </div>

    <app-terminal-game-component-host *ngIf="lessonConnected"></app-terminal-game-component-host>

    <div class="connection-form" *ngIf="!lessonConnected">
      <h1>היי!</h1>
      <p>
        כדי להתחבר לשיעור, אנחנו רק צריכים לדעת את השם שלך. אנא הזן אותו למטה, ולחץ על ״התחבר״.
      </p>

      <mat-form-field appearance="fill" class="form-field-rtl">
        <mat-label>שם</mat-label>
        <input matInput [(ngModel)]="username" value="">
      </mat-form-field>

      <div class="horizontal-stack" style="width: 100%">
        בחר/י דמות:
        <div class="flex-spacer"></div>
        <app-avatar-view
          *ngFor="let avatar of suggestedAvatars; index as avIndex"
          [avatar]="avatar"
          [ngClass]="{ selected: selectedAvatarIndex == avIndex}"
          (click)="selectedAvatarIndex = avIndex"
          size="big">
        </app-avatar-view>
      </div>

      <button mat-raised-button (click)="handleConnectClicked()">התחבר</button>

    </div>
  </div>

</app-lesson-terminal-provider>
